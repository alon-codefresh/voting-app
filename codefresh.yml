version: '1.0'

steps:

  unit_test:
    type: composition
    working_directory: ${{main_clone}}
    composition:
      version: '2'
      services:
        redis:
          image: 'redis:alpine'
          container_name: redis
          ports:
            - '6379'
    composition_candidates:
      test:
        image: redis:alpine
        command: 'echo "CF_BUILD_ID is $CF_BUILD_ID" && pwd && ls && sleep 30 && pwd && ls && echo "CF_BRANCH is ${{CF_BRANCH}} and CF_VOLUME_PATH is ${{CF_VOLUME_PATH}}"'
        volumes:
          - '${{CF_VOLUME_NAME}}:/codefresh/'

