version: '1.0'

steps:

  unit_test:
    type: composition
    working_directory: ${{main_clone}}
    composition:
      version: '2'
      services:
        redis:
          image: 'redis:alpine'
          container_name: redis
          ports:
            - '6379'
    composition_candidates:
      test:
        image: redis:alpine
        command: bash -c 'sleep 30 && echo branch1 ${CF_BRANCH} path1 ${CF_VOLUME_PATH}'
        volumes:
          - 'db-data:/var/lib/postgresql/data'
          - '${{CF_VOLUME_NAME}}:/codefresh/'

